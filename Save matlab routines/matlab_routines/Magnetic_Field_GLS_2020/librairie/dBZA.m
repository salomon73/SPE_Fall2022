function dBZA = dBZA(l,a,b,z)%% function dBZA = dBZA(l,a,b,z)%% Returns the FIRST derivative of the on-axis magnetic field % associated to a rectangular coil centered on z=0% in which a unit current density 1/(a*b) [A/m^2] is flowing% The analytic formula is exact on the axis and is based on% Martin Wilson: 'Superconducting Magnets', Oxford Science publications, 1990, p20.% plus some cumbersome derivation.% %%	Version:	1.0		J.-P. Hogge		Sept 25, 2001%%   a	: Minor radius%	b	: major radius%   l   : longitudinal extent of the coil (from -l/2 to +l/2)%   z	: a one-dimensional array	mu0 = 4*pi*1e-7;		T1	= T(l,a,b,-z);	T2	= T(l,a,b,z);	T3	= T(l,a,a,-z);	T4  = T(l,a,a,z);		T5  = (T1-b/a).^2;	T6  = (T2-b/a).^2;	T7  = (T3-1).^2;	T8  = (T4-1).^2;			dBZA = mu0/2 * ( ...					  ((T1 .* sqrt(T5) -T3.*sqrt(T7))./(4*a^2 * T1.*T3.*sqrt(T5).*sqrt(T7))).*(l-2*z).^2 ...						- ((T2 .* sqrt(T6) -T4.*sqrt(T8))./(4*a^2 * T2.*T4.*sqrt(T6).*sqrt(T8))).*(l+2*z).^2 ...					- log(T1./T3) ...					+ log(T2./T4) ...					);		return
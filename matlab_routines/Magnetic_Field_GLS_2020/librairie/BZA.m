function BZA = BZA(l,a,b,z)%% function BZA = BZA(l,a,b,z)%% Returns the on-axis magnetic field associated to a rectangular coil centered on z=0% in which a unit current density 1/(a*b) [A/m^2] is flowing% The analytic formula is exact on the axis and is based on% Martin Wilson: 'Superconducting Magnets', Oxford Science publications, 1990, p20.% %%	Version:	1.0		J.-P. Hogge		Sept 25, 2001%%   a	: Minor radius%	b	: major radisu%   l   : longitudinal extent of the coil (from -l/2 to +l/2)%   z	: a one-dimensional array	mu0 = 4*pi*1e-7;		T1	= T(l,a,b,-z);	T2	= T(l,a,b,z);	T3	= T(l,a,a,-z);	T4  = T(l,a,a,z);		BZA =mu0/4 * ( (l-2*z).*log(T1./T3) + (l+2*z).*log(T2./T4));		return